
Функция ВЧислоБезопасно(Знач Значение) Экспорт

	Если Значение = Неопределено Тогда
		Возврат 0;
	КонецЕсли;

	Если ТипЗнч(Значение) = Тип("Число") Тогда
		Возврат Значение;
	КонецЕсли;

	Стр = СокрЛП(Строка(Значение));
	Если Стр = "" Тогда
		Возврат 0;
	КонецЕсли;

	Стр = СтрЗаменить(Стр, """", "");
	Стр = СтрЗаменить(Стр, Символы.НПП, "");
	Стр = СтрЗаменить(Стр, " ", "");
	Стр = СтрЗаменить(Стр, ",", ".");

	Попытка
		Возврат Число(Стр);
	Исключение
		Возврат 0;
	КонецПопытки;

КонецФункции

Функция НормСтрока(Знач Стр) Экспорт
	
	Если Стр = Неопределено Тогда
		Возврат "";
	КонецЕсли;
	Рез = СокрЛП(Строка(Стр));
	Рез = СтрЗаменить(Рез, """", "");
	Возврат Рез;
	
КонецФункции

Функция ВЧисло(Знач Стр) Экспорт
	
	Т = НормСтрока(Стр);
	Если Т = "" Тогда
		Возврат 0;
	КонецЕсли;
	Т = СтрЗаменить(Т, Символы.НПП, "");
	Т = СтрЗаменить(Т, " ", "");
	Т = СтрЗаменить(Т, ",", ".");
	
	Попытка
		Возврат Число(Т);
	Исключение
		Возврат 0;
	КонецПопытки;
	
КонецФункции